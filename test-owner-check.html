<!DOCTYPE html>
<html>
<head>
    <title>Owner Check Test</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .success { color: green; font-weight: bold; }
        .failure { color: red; font-weight: bold; }
        pre { background: #f4f4f4; padding: 10px; }
    </style>
</head>
<body>
    <h1>Testing Pitch Owner Check</h1>
    <div id="results"></div>

    <script>
        async function testOwnerCheck() {
            const results = document.getElementById('results');
            
            // Login first
            const loginResponse = await fetch('http://localhost:8001/api/auth/creator/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    email: 'alex.creator@demo.com',
                    password: 'Demo123'
                })
            });
            
            const loginData = await loginResponse.json();
            const token = loginData.token;
            const currentUser = loginData.user;
            
            results.innerHTML += `<p>Logged in as user ID: ${currentUser.id}</p>`;
            
            // Fetch pitch 63
            const pitchResponse = await fetch('http://localhost:8001/api/creator/pitches/63', {
                headers: { 'Authorization': `Bearer ${token}` }
            });
            
            const pitchData = await pitchResponse.json();
            const pitch = pitchData.data?.pitch || pitchData.pitch;
            
            results.innerHTML += `<p>Pitch 63 creator ID: ${pitch?.creator?.id}</p>`;
            results.innerHTML += `<p>Pitch 63 userId: ${pitch?.userId}</p>`;
            
            // Check if owner
            const isOwner = pitch?.creator?.id && currentUser?.id && 
                           Number(pitch.creator.id) === Number(currentUser.id);
            
            results.innerHTML += `<h2>Owner Check Result:</h2>`;
            results.innerHTML += `<p>Comparing: ${pitch?.creator?.id} === ${currentUser?.id}</p>`;
            
            if (isOwner) {
                results.innerHTML += `<p class="success">✅ IS OWNER - Should see Edit/Analytics buttons</p>`;
            } else {
                results.innerHTML += `<p class="failure">❌ NOT OWNER - Should see NDA/Request Access buttons</p>`;
            }
            
            results.innerHTML += `<h3>Full Data:</h3>`;
            results.innerHTML += `<pre>${JSON.stringify({ currentUser, pitch }, null, 2)}</pre>`;
        }
        
        testOwnerCheck();
    </script>
</body>
</html>