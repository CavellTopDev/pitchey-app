<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pitchey Security Audit Report - Hardcoded Elements Analysis</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        .risk-banner {
            background: #e74c3c;
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        .content {
            padding: 40px;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .stat-card {
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .stat-card:hover {
            transform: translateY(-5px);
        }
        .stat-critical {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        .stat-high {
            background: linear-gradient(135deg, #e67e22, #d35400);
            color: white;
        }
        .stat-medium {
            background: linear-gradient(135deg, #f39c12, #f1c40f);
            color: white;
        }
        .stat-low {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }
        .stat-info {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: white;
        }
        .stat-number {
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
        }
        .stat-label {
            font-size: 1.1em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .section {
            margin: 40px 0;
        }
        .section-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .section-header h2 {
            flex: 1;
        }
        .badge {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }
        .finding {
            background: #f8f9fa;
            padding: 20px;
            border-left: 4px solid;
            margin-bottom: 15px;
            border-radius: 5px;
            transition: all 0.3s;
        }
        .finding:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .finding-critical { border-left-color: #e74c3c; }
        .finding-high { border-left-color: #e67e22; }
        .finding-medium { border-left-color: #f39c12; }
        .finding-low { border-left-color: #3498db; }
        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .severity {
            padding: 3px 10px;
            border-radius: 3px;
            color: white;
            font-weight: bold;
            font-size: 0.85em;
        }
        .severity-critical { background: #e74c3c; }
        .severity-high { background: #e67e22; }
        .severity-medium { background: #f39c12; }
        .severity-low { background: #3498db; }
        .finding-location {
            color: #666;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin-top: 10px;
        }
        .owasp-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .owasp-table th {
            background: #34495e;
            color: white;
            padding: 15px;
            text-align: left;
        }
        .owasp-table td {
            padding: 15px;
            border-bottom: 1px solid #ecf0f1;
        }
        .owasp-table tr:hover {
            background: #f8f9fa;
        }
        .status-critical { color: #e74c3c; font-weight: bold; }
        .status-warning { color: #f39c12; font-weight: bold; }
        .status-ok { color: #27ae60; font-weight: bold; }
        .recommendations {
            background: linear-gradient(135deg, #f8f9fa, #ecf0f1);
            padding: 30px;
            border-radius: 10px;
            margin: 30px 0;
        }
        .rec-list {
            list-style: none;
        }
        .rec-list li {
            padding: 15px;
            margin: 10px 0;
            background: white;
            border-radius: 5px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .rec-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
        }
        .priority-1 { background: #e74c3c; color: white; }
        .priority-2 { background: #e67e22; color: white; }
        .priority-3 { background: #f39c12; color: white; }
        .footer {
            background: #2c3e50;
            color: white;
            padding: 30px;
            text-align: center;
        }
        .chart-container {
            width: 100%;
            height: 300px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîí Pitchey Security Audit Report</h1>
            <p>Comprehensive Hardcoded Elements Analysis</p>
            <p>Generated: Sunday, September 28, 2025</p>
        </div>

        <div class="risk-banner">
            ‚ö†Ô∏è CRITICAL SECURITY RISK DETECTED - DO NOT DEPLOY TO PRODUCTION
        </div>

        <div class="content">
            <!-- Executive Summary -->
            <div class="section">
                <div class="section-header">
                    <h2>üìä Executive Summary</h2>
                    <span class="badge">Total Issues: 231</span>
                </div>
                
                <div class="summary-grid">
                    <div class="stat-card stat-critical">
                        <div class="stat-label">Critical</div>
                        <div class="stat-number">16</div>
                        <div>Immediate Action Required</div>
                    </div>
                    <div class="stat-card stat-high">
                        <div class="stat-label">High</div>
                        <div class="stat-number">131</div>
                        <div>Fix Before Production</div>
                    </div>
                    <div class="stat-card stat-medium">
                        <div class="stat-label">Medium</div>
                        <div class="stat-number">69</div>
                        <div>Plan Remediation</div>
                    </div>
                    <div class="stat-card stat-low">
                        <div class="stat-label">Low</div>
                        <div class="stat-number">15</div>
                        <div>Best Practice Issues</div>
                    </div>
                </div>
            </div>

            <!-- Critical Findings -->
            <div class="section">
                <div class="section-header">
                    <h2>üö® Critical Security Issues</h2>
                    <span class="badge">16 Issues</span>
                </div>

                <div class="finding finding-critical">
                    <div class="finding-header">
                        <strong>Hardcoded Passwords (7 instances)</strong>
                        <span class="severity severity-critical">CRITICAL</span>
                    </div>
                    <p>Multiple hardcoded passwords found in production code, including Login.tsx, Register.tsx, and password-validation.ts</p>
                    <div class="finding-location">Files: src/utils/password-validation.ts, frontend/src/pages/Login.tsx, frontend/src/pages/Register.tsx</div>
                </div>

                <div class="finding finding-critical">
                    <div class="finding-header">
                        <strong>Hardcoded JWT Secrets (6 instances)</strong>
                        <span class="severity severity-critical">CRITICAL</span>
                    </div>
                    <p>JWT secrets are hardcoded instead of using environment variables</p>
                    <div class="finding-location">Files: src/utils/jwt.ts, src/services/auth.service.ts, src/middleware/auth.middleware.ts</div>
                </div>

                <div class="finding finding-critical">
                    <div class="finding-header">
                        <strong>SQL Injection Vulnerabilities (3 instances)</strong>
                        <span class="severity severity-critical">CRITICAL</span>
                    </div>
                    <p>String concatenation in SQL queries creating injection risks</p>
                    <div class="finding-location">Files: src/services/analytics.service.ts, src/services/nda.service.ts</div>
                </div>

                <div class="finding finding-critical">
                    <div class="finding-header">
                        <strong>.env File in Repository</strong>
                        <span class="severity severity-critical">CRITICAL</span>
                    </div>
                    <p>.env file committed to repository exposing sensitive configuration</p>
                    <div class="finding-location">File: .env (root directory)</div>
                </div>
            </div>

            <!-- High Risk Issues -->
            <div class="section">
                <div class="section-header">
                    <h2>‚ö†Ô∏è High Risk Issues</h2>
                    <span class="badge">131 Issues</span>
                </div>

                <div class="finding finding-high">
                    <div class="finding-header">
                        <strong>Weak Passwords in Code (115 instances)</strong>
                        <span class="severity severity-high">HIGH</span>
                    </div>
                    <p>Weak passwords like 'test', 'demo', 'admin', '123456' found throughout codebase</p>
                    <div class="finding-location">Multiple files in src/ and frontend/src/</div>
                </div>

                <div class="finding finding-high">
                    <div class="finding-header">
                        <strong>Hardcoded Production URLs (19 instances)</strong>
                        <span class="severity severity-high">HIGH</span>
                    </div>
                    <p>Production URLs hardcoded instead of using environment variables</p>
                    <div class="finding-location">Files: email services, notification services, security config</div>
                </div>

                <div class="finding finding-high">
                    <div class="finding-header">
                        <strong>CORS Wildcard Configuration (3 instances)</strong>
                        <span class="severity severity-high">HIGH</span>
                    </div>
                    <p>CORS configured to allow all origins (*) creating security risk</p>
                    <div class="finding-location">Files: src/utils/response.ts, src/config/security.config.ts</div>
                </div>

                <div class="finding finding-high">
                    <div class="finding-header">
                        <strong>Security TODOs (9 instances)</strong>
                        <span class="severity severity-high">HIGH</span>
                    </div>
                    <p>Unaddressed security-related TODO comments in production code</p>
                    <div class="finding-location">Files: jwt.ts, rate-limit.middleware.ts, security.middleware.ts</div>
                </div>
            </div>

            <!-- OWASP Compliance -->
            <div class="section">
                <div class="section-header">
                    <h2>üõ°Ô∏è OWASP Top 10 Compliance Assessment</h2>
                </div>

                <table class="owasp-table">
                    <tr>
                        <th>OWASP Category</th>
                        <th>Status</th>
                        <th>Issues Found</th>
                        <th>Recommendation</th>
                    </tr>
                    <tr>
                        <td>A01: Broken Access Control</td>
                        <td class="status-warning">‚ö†Ô∏è Review Needed</td>
                        <td>Auth middleware needs review</td>
                        <td>Implement proper RBAC and access controls</td>
                    </tr>
                    <tr>
                        <td>A02: Cryptographic Failures</td>
                        <td class="status-critical">‚ùå Critical</td>
                        <td>16 hardcoded secrets found</td>
                        <td>Use environment variables and key management</td>
                    </tr>
                    <tr>
                        <td>A03: Injection</td>
                        <td class="status-critical">‚ùå Critical</td>
                        <td>3 SQL injection vulnerabilities</td>
                        <td>Use parameterized queries</td>
                    </tr>
                    <tr>
                        <td>A04: Insecure Design</td>
                        <td class="status-warning">‚ö†Ô∏è Issues Found</td>
                        <td>No centralized config management</td>
                        <td>Implement config module with validation</td>
                    </tr>
                    <tr>
                        <td>A05: Security Misconfiguration</td>
                        <td class="status-critical">‚ùå Critical</td>
                        <td>CORS wildcard, hardcoded configs</td>
                        <td>Restrict CORS, externalize configuration</td>
                    </tr>
                    <tr>
                        <td>A06: Vulnerable Components</td>
                        <td class="status-warning">‚ö†Ô∏è Check Required</td>
                        <td>Dependencies not audited</td>
                        <td>Run npm audit and update packages</td>
                    </tr>
                    <tr>
                        <td>A07: Authentication Failures</td>
                        <td class="status-critical">‚ùå Critical</td>
                        <td>Weak passwords, JWT issues</td>
                        <td>Implement strong password policy, secure JWT</td>
                    </tr>
                    <tr>
                        <td>A08: Data Integrity Failures</td>
                        <td class="status-warning">‚ö†Ô∏è Review Needed</td>
                        <td>Input validation needs review</td>
                        <td>Implement comprehensive validation</td>
                    </tr>
                    <tr>
                        <td>A09: Security Logging</td>
                        <td class="status-warning">‚ö†Ô∏è Issues Found</td>
                        <td>Potential PII in logs</td>
                        <td>Implement log sanitization</td>
                    </tr>
                    <tr>
                        <td>A10: SSRF</td>
                        <td class="status-warning">‚ö†Ô∏è Review Needed</td>
                        <td>URL validation needed</td>
                        <td>Implement URL allowlist</td>
                    </tr>
                </table>
            </div>

            <!-- Priority Recommendations -->
            <div class="recommendations">
                <h2>üéØ Priority Action Items</h2>
                
                <ul class="rec-list">
                    <li>
                        <div class="rec-icon priority-1">1</div>
                        <div>
                            <strong>IMMEDIATE: Remove All Hardcoded Credentials</strong>
                            <p>Move all passwords, API keys, JWT secrets to environment variables. Use a secure vault for production.</p>
                        </div>
                    </li>
                    <li>
                        <div class="rec-icon priority-1">2</div>
                        <div>
                            <strong>IMMEDIATE: Fix SQL Injection Vulnerabilities</strong>
                            <p>Replace string concatenation with parameterized queries or use ORM properly.</p>
                        </div>
                    </li>
                    <li>
                        <div class="rec-icon priority-1">3</div>
                        <div>
                            <strong>IMMEDIATE: Remove .env from Repository</strong>
                            <p>Add .env to .gitignore, rotate all exposed secrets, use .env.example for documentation.</p>
                        </div>
                    </li>
                    <li>
                        <div class="rec-icon priority-2">4</div>
                        <div>
                            <strong>HIGH: Implement Environment Variable Validation</strong>
                            <p>Create src/config/env.ts with Zod validation for all environment variables.</p>
                        </div>
                    </li>
                    <li>
                        <div class="rec-icon priority-2">5</div>
                        <div>
                            <strong>HIGH: Fix CORS Configuration</strong>
                            <p>Replace wildcard (*) with specific allowed origins from environment configuration.</p>
                        </div>
                    </li>
                    <li>
                        <div class="rec-icon priority-2">6</div>
                        <div>
                            <strong>HIGH: Remove Weak Passwords and Demo Data</strong>
                            <p>Remove all test/demo credentials from production code. Move to separate test fixtures.</p>
                        </div>
                    </li>
                    <li>
                        <div class="rec-icon priority-3">7</div>
                        <div>
                            <strong>MEDIUM: Centralize Configuration</strong>
                            <p>Create a configuration module to manage all application settings from environment variables.</p>
                        </div>
                    </li>
                    <li>
                        <div class="rec-icon priority-3">8</div>
                        <div>
                            <strong>MEDIUM: Replace Magic Numbers</strong>
                            <p>Define all numeric constants with descriptive names in a constants file.</p>
                        </div>
                    </li>
                </ul>
            </div>

            <!-- Security Checklist -->
            <div class="section">
                <div class="section-header">
                    <h2>‚úÖ Security Implementation Checklist</h2>
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h3>Before Production Deployment:</h3>
                    <ul style="list-style: none; padding: 0;">
                        <li style="padding: 10px;">‚òê All CRITICAL issues resolved</li>
                        <li style="padding: 10px;">‚òê Environment variables properly configured</li>
                        <li style="padding: 10px;">‚òê Secrets rotated and secured</li>
                        <li style="padding: 10px;">‚òê SQL injection vulnerabilities fixed</li>
                        <li style="padding: 10px;">‚òê CORS properly configured</li>
                        <li style="padding: 10px;">‚òê JWT implementation secured</li>
                        <li style="padding: 10px;">‚òê Input validation implemented</li>
                        <li style="padding: 10px;">‚òê Security headers configured</li>
                        <li style="padding: 10px;">‚òê Rate limiting enabled</li>
                        <li style="padding: 10px;">‚òê Logging sanitized for PII</li>
                        <li style="padding: 10px;">‚òê Dependencies audited (npm audit)</li>
                        <li style="padding: 10px;">‚òê Security testing in CI/CD</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="footer">
            <h3>Security Audit Complete</h3>
            <p>This report identifies 231 security issues requiring immediate attention.</p>
            <p>Do not deploy to production until all CRITICAL issues are resolved.</p>
            <p style="margin-top: 20px; opacity: 0.8;">
                Generated by Pitchey Security Scanner v1.0<br>
                Report Date: September 28, 2025
            </p>
        </div>
    </div>
</body>
</html>