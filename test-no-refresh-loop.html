<!DOCTYPE html>
<html>
<head>
    <title>Test No Refresh Loop</title>
</head>
<body>
    <h1>Testing Pitchey Homepage - No Refresh Loop</h1>
    <iframe id="testFrame" src="http://127.0.0.1:5173/" width="100%" height="600"></iframe>
    
    <div id="status">
        <h2>Refresh Detection:</h2>
        <p>Load count: <span id="loadCount">0</span></p>
        <p>Status: <span id="statusText">Monitoring...</span></p>
    </div>
    
    <script>
        let loadCount = 0;
        let lastLoadTime = Date.now();
        
        const iframe = document.getElementById('testFrame');
        const loadCountEl = document.getElementById('loadCount');
        const statusEl = document.getElementById('statusText');
        
        iframe.onload = function() {
            loadCount++;
            loadCountEl.textContent = loadCount;
            
            const now = Date.now();
            const timeSinceLastLoad = now - lastLoadTime;
            lastLoadTime = now;
            
            if (loadCount > 1 && timeSinceLastLoad < 2000) {
                statusEl.textContent = '⚠️ REFRESH LOOP DETECTED!';
                statusEl.style.color = 'red';
            } else if (loadCount === 1) {
                statusEl.textContent = '✅ Initial load successful';
                statusEl.style.color = 'green';
                
                // Wait 5 seconds to see if there's a delayed refresh
                setTimeout(() => {
                    if (loadCount === 1) {
                        statusEl.textContent = '✅ NO REFRESH LOOP - Page stable for 5 seconds!';
                        statusEl.style.color = 'green';
                        statusEl.style.fontWeight = 'bold';
                    }
                }, 5000);
            }
        };
    </script>
</body>
</html>