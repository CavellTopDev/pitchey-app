<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pitchey - Where Ideas Meet Investment</title>
    
    <!-- DNS prefetch for API domain to reduce resolution delays -->
    <link rel="dns-prefetch" href="//pitchey-api-prod.cavelltheleaddev.workers.dev">
    <link rel="preconnect" href="https://pitchey-api-prod.cavelltheleaddev.workers.dev" crossorigin>
  </head>
  <body>
    <!-- React 18 AsyncMode Compatibility Fix -->
    <script>
      // Immediate fix for AsyncMode issues before any modules load
      (function() {
        // Protect React object from AsyncMode assignments
        if (typeof Object.defineProperty === 'function') {
          var reactProxy = {};
          var reactHandler = {
            get: function(target, prop) {
              if (prop === 'AsyncMode' || prop === 'unstable_AsyncMode') {
                // Return Fragment as fallback for deprecated AsyncMode
                return target.Fragment || function(props) { 
                  return props && props.children ? props.children : null; 
                };
              }
              return target[prop];
            },
            set: function(target, prop, value) {
              var deprecatedProps = ['AsyncMode', 'unstable_AsyncMode', 'isAsyncMode', 'isConcurrentMode'];
              var reactProps = ['ContextConsumer', 'ContextProvider', 'Fragment', 'Element', 'ForwardRef', 'Lazy', 'Memo', 'Portal', 'Profiler', 'StrictMode', 'Suspense', 'SuspenseList', 'isContextConsumer', 'isContextProvider', 'isElement', 'isForwardRef', 'isFragment', 'isLazy', 'isMemo', 'isPortal', 'isProfiler', 'isStrictMode', 'isSuspense', 'isSuspenseList', 'isValidElementType', 'typeOf'];
              
              if (deprecatedProps.includes(prop)) {
                // Silently ignore deprecated props to prevent errors
                console.warn(prop + ' is deprecated in React 18 - assignment ignored');
                return true;
              }
              
              if (reactProps.includes(prop)) {
                // Handle React property assignments safely
                try {
                  if (target && typeof target === 'object') {
                    target[prop] = value;
                    return true;
                  } else {
                    console.warn('Cannot set ' + prop + ' on undefined React object');
                    return false;
                  }
                } catch(e) {
                  console.warn('Failed to set React.' + prop, e);
                  return false;
                }
              }
              
              try {
                target[prop] = value;
                return true;
              } catch(e) {
                console.warn('Failed to set React.' + prop, e);
                return false;
              }
            }
          };
          
          // Set up global React protection
          Object.defineProperty(window, 'React', {
            get: function() { 
              return typeof Proxy !== 'undefined' ? new Proxy(reactProxy, reactHandler) : reactProxy; 
            },
            set: function(value) { 
              if (value && typeof value === 'object') {
                Object.assign(reactProxy, value);
                // Ensure Fragment exists as fallback
                if (!reactProxy.Fragment) {
                  reactProxy.Fragment = function(props) { return props.children; };
                }
              }
              return true;
            },
            configurable: true
          });
        }
      })();

      // UMD Module Definition Polyfill (based on Context7 webpack patterns)
      (function() {
        // Implement the exact UMD pattern from Context7 docs
        if (typeof window !== 'undefined') {
          // Define exports object if it doesn't exist
          if (typeof window.exports === 'undefined') {
            window.exports = {};
          }
          
          // Define module object if it doesn't exist (CommonJS compatibility)
          if (typeof window.module === 'undefined') {
            window.module = { exports: window.exports };
          }
          
          // Global UMD factory function for safe module loading
          window.webpackUniversalModuleDefinition = function(root, factory) {
            if (typeof exports === 'object' && typeof module === 'object') {
              module.exports = factory();
            } else if (typeof define === 'function' && define.amd) {
              define([], factory);
            } else if (typeof exports === 'object') {
              var result = factory();
              for (var key in result) {
                if (result.hasOwnProperty && result.hasOwnProperty(key)) {
                  exports[key] = result[key];
                }
              }
            } else {
              var result = factory();
              for (var key in result) {
                if (result.hasOwnProperty && result.hasOwnProperty(key)) {
                  root[key] = result[key];
                }
              }
            }
          };
          
          // Ensure exports is always an object
          Object.defineProperty(window, 'exports', {
            get: function() { 
              return window.__moduleExports || (window.__moduleExports = {}); 
            },
            set: function(value) { 
              window.__moduleExports = value || {};
              if (window.module) {
                window.module.exports = window.__moduleExports;
              }
            },
            configurable: true,
            enumerable: true
          });
        }
      })();
    </script>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
