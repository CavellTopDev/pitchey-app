<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pitchey - Cost Monitoring Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            color: white;
            margin-bottom: 30px;
            font-size: 2.5rem;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .card h2 {
            font-size: 1.2rem;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .metric:last-child {
            border-bottom: none;
        }
        
        .metric-label {
            color: #666;
            font-size: 0.9rem;
        }
        
        .metric-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #333;
        }
        
        .metric-value.cost {
            color: #22c55e;
        }
        
        .metric-value.warning {
            color: #f59e0b;
        }
        
        .metric-value.danger {
            color: #ef4444;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #22c55e, #10b981);
            transition: width 0.3s ease;
        }
        
        .progress-fill.warning {
            background: linear-gradient(90deg, #f59e0b, #f97316);
        }
        
        .progress-fill.danger {
            background: linear-gradient(90deg, #ef4444, #dc2626);
        }
        
        .chart {
            height: 200px;
            margin-top: 20px;
            position: relative;
        }
        
        .chart-bar {
            display: inline-block;
            width: calc(100% / 7 - 4px);
            margin: 0 2px;
            background: #667eea;
            border-radius: 4px 4px 0 0;
            transition: all 0.3s ease;
            position: absolute;
            bottom: 0;
        }
        
        .chart-bar:hover {
            background: #764ba2;
        }
        
        .recommendations {
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .recommendation {
            display: flex;
            align-items: start;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .recommendation:last-child {
            margin-bottom: 0;
        }
        
        .recommendation-icon {
            color: #0ea5e9;
            font-size: 1.2rem;
        }
        
        .recommendation-text {
            color: #0c4a6e;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .alert {
            background: #fef2f2;
            border: 2px solid #ef4444;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .alert-icon {
            color: #ef4444;
            font-size: 1.5rem;
        }
        
        .alert-text {
            color: #991b1b;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        .status-indicator.healthy {
            background: #22c55e;
            animation: pulse-green 2s infinite;
        }
        
        .status-indicator.warning {
            background: #f59e0b;
            animation: pulse-yellow 2s infinite;
        }
        
        .status-indicator.danger {
            background: #ef4444;
            animation: pulse-red 2s infinite;
        }
        
        @keyframes pulse-green {
            0%, 100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); }
        }
        
        @keyframes pulse-yellow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(245, 158, 11, 0); }
        }
        
        @keyframes pulse-red {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
        }
        
        .refresh-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: white;
            color: #667eea;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        .refresh-btn:hover {
            transform: rotate(180deg) scale(1.1);
            background: #667eea;
            color: white;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <h1>üöÄ Pitchey Cost Monitoring Dashboard</h1>
        
        <div id="alerts"></div>
        
        <div class="grid">
            <!-- Current Month Costs -->
            <div class="card">
                <h2>üí∞ Current Month Costs</h2>
                <div class="metric">
                    <span class="metric-label">Total Cost</span>
                    <span class="metric-value cost" id="total-cost">$0.00</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Projected Monthly</span>
                    <span class="metric-value" id="projected-cost">$0.00</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Budget Usage</span>
                    <span class="metric-value" id="budget-usage">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="budget-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <!-- Service Breakdown -->
            <div class="card">
                <h2>üìä Service Breakdown</h2>
                <div class="metric">
                    <span class="metric-label">Workers</span>
                    <span class="metric-value" id="workers-cost">$0.00</span>
                </div>
                <div class="metric">
                    <span class="metric-label">KV Storage</span>
                    <span class="metric-value" id="kv-cost">$0.00</span>
                </div>
                <div class="metric">
                    <span class="metric-label">R2 Storage</span>
                    <span class="metric-value" id="r2-cost">$0.00</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Durable Objects</span>
                    <span class="metric-value" id="do-cost">$0.00</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Database</span>
                    <span class="metric-value" id="db-cost">$0.00</span>
                </div>
            </div>
            
            <!-- Usage Metrics -->
            <div class="card">
                <h2>üìà Usage Metrics</h2>
                <div class="metric">
                    <span class="metric-label">Requests/Day</span>
                    <span class="metric-value" id="daily-requests">0</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Bandwidth/Day</span>
                    <span class="metric-value" id="daily-bandwidth">0 GB</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Active Users</span>
                    <span class="metric-value" id="active-users">0</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Storage Used</span>
                    <span class="metric-value" id="storage-used">0 GB</span>
                </div>
            </div>
            
            <!-- Regional Distribution -->
            <div class="card">
                <h2>üåç Regional Distribution</h2>
                <div class="metric">
                    <span class="metric-label">US East</span>
                    <span class="metric-value">
                        <span class="status-indicator healthy"></span>
                        <span id="us-east-traffic">0%</span>
                    </span>
                </div>
                <div class="metric">
                    <span class="metric-label">US West</span>
                    <span class="metric-value">
                        <span class="status-indicator healthy"></span>
                        <span id="us-west-traffic">0%</span>
                    </span>
                </div>
                <div class="metric">
                    <span class="metric-label">Europe</span>
                    <span class="metric-value">
                        <span class="status-indicator healthy"></span>
                        <span id="eu-traffic">0%</span>
                    </span>
                </div>
                <div class="metric">
                    <span class="metric-label">Asia Pacific</span>
                    <span class="metric-value">
                        <span class="status-indicator healthy"></span>
                        <span id="asia-traffic">0%</span>
                    </span>
                </div>
            </div>
            
            <!-- Performance -->
            <div class="card">
                <h2>‚ö° Performance</h2>
                <div class="metric">
                    <span class="metric-label">Avg Latency</span>
                    <span class="metric-value" id="avg-latency">0ms</span>
                </div>
                <div class="metric">
                    <span class="metric-label">P95 Latency</span>
                    <span class="metric-value" id="p95-latency">0ms</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Cache Hit Rate</span>
                    <span class="metric-value" id="cache-hit-rate">0%</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Error Rate</span>
                    <span class="metric-value" id="error-rate">0%</span>
                </div>
            </div>
            
            <!-- Optimization Score -->
            <div class="card">
                <h2>üéØ Optimization Score</h2>
                <div class="metric">
                    <span class="metric-label">Overall Score</span>
                    <span class="metric-value" id="optimization-score">0/100</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="optimization-progress" style="width: 0%"></div>
                </div>
                <div class="metric">
                    <span class="metric-label">Cost Efficiency</span>
                    <span class="metric-value" id="cost-efficiency">0%</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Resource Utilization</span>
                    <span class="metric-value" id="resource-utilization">0%</span>
                </div>
            </div>
        </div>
        
        <!-- Cost Trend Chart -->
        <div class="card">
            <h2>üìâ 7-Day Cost Trend</h2>
            <div class="chart" id="cost-chart"></div>
        </div>
        
        <!-- Recommendations -->
        <div class="card">
            <h2>üí° Cost Optimization Recommendations</h2>
            <div id="recommendations" class="recommendations"></div>
        </div>
        
        <button class="refresh-btn" onclick="refreshDashboard()">‚Üª</button>
    </div>
    
    <script>
        // Simulated data - In production, this would fetch from actual monitoring endpoints
        const mockData = {
            currentCosts: {
                total: 127.43,
                projected: 382.29,
                budget: 500,
                workers: 45.20,
                kv: 12.30,
                r2: 8.50,
                durableObjects: 15.43,
                database: 46.00
            },
            usage: {
                dailyRequests: 2450000,
                dailyBandwidth: 125.3,
                activeUsers: 15234,
                storageUsed: 234.5
            },
            regional: {
                usEast: 35,
                usWest: 28,
                europe: 22,
                asia: 15
            },
            performance: {
                avgLatency: 45,
                p95Latency: 120,
                cacheHitRate: 85,
                errorRate: 0.05
            },
            optimization: {
                score: 78,
                costEfficiency: 82,
                resourceUtilization: 74
            },
            trend: [95.20, 102.30, 118.50, 125.40, 130.20, 122.10, 127.43],
            recommendations: [
                "Enable aggressive caching for static assets to reduce Workers compute costs",
                "Implement request coalescing for duplicate API calls (potential 15% cost reduction)",
                "Move infrequently accessed data to R2 cold storage tier",
                "Optimize database queries - 3 slow queries identified consuming 25% of database resources",
                "Consider implementing regional caching to reduce cross-region data transfer costs"
            ],
            alerts: []
        };
        
        function updateDashboard(data) {
            // Update costs
            document.getElementById('total-cost').textContent = `$${data.currentCosts.total.toFixed(2)}`;
            document.getElementById('projected-cost').textContent = `$${data.currentCosts.projected.toFixed(2)}`;
            
            const budgetUsage = (data.currentCosts.projected / data.currentCosts.budget * 100);
            document.getElementById('budget-usage').textContent = `${budgetUsage.toFixed(1)}%`;
            
            const budgetProgress = document.getElementById('budget-progress');
            budgetProgress.style.width = `${Math.min(budgetUsage, 100)}%`;
            budgetProgress.className = `progress-fill ${budgetUsage > 90 ? 'danger' : budgetUsage > 75 ? 'warning' : ''}`;
            
            // Update service breakdown
            document.getElementById('workers-cost').textContent = `$${data.currentCosts.workers.toFixed(2)}`;
            document.getElementById('kv-cost').textContent = `$${data.currentCosts.kv.toFixed(2)}`;
            document.getElementById('r2-cost').textContent = `$${data.currentCosts.r2.toFixed(2)}`;
            document.getElementById('do-cost').textContent = `$${data.currentCosts.durableObjects.toFixed(2)}`;
            document.getElementById('db-cost').textContent = `$${data.currentCosts.database.toFixed(2)}`;
            
            // Update usage
            document.getElementById('daily-requests').textContent = 
                data.usage.dailyRequests.toLocaleString();
            document.getElementById('daily-bandwidth').textContent = 
                `${data.usage.dailyBandwidth.toFixed(1)} GB`;
            document.getElementById('active-users').textContent = 
                data.usage.activeUsers.toLocaleString();
            document.getElementById('storage-used').textContent = 
                `${data.usage.storageUsed.toFixed(1)} GB`;
            
            // Update regional
            document.getElementById('us-east-traffic').textContent = `${data.regional.usEast}%`;
            document.getElementById('us-west-traffic').textContent = `${data.regional.usWest}%`;
            document.getElementById('eu-traffic').textContent = `${data.regional.europe}%`;
            document.getElementById('asia-traffic').textContent = `${data.regional.asia}%`;
            
            // Update performance
            document.getElementById('avg-latency').textContent = `${data.performance.avgLatency}ms`;
            document.getElementById('p95-latency').textContent = `${data.performance.p95Latency}ms`;
            document.getElementById('cache-hit-rate').textContent = `${data.performance.cacheHitRate}%`;
            document.getElementById('error-rate').textContent = `${data.performance.errorRate}%`;
            
            // Update optimization
            document.getElementById('optimization-score').textContent = `${data.optimization.score}/100`;
            document.getElementById('optimization-progress').style.width = `${data.optimization.score}%`;
            document.getElementById('cost-efficiency').textContent = `${data.optimization.costEfficiency}%`;
            document.getElementById('resource-utilization').textContent = `${data.optimization.resourceUtilization}%`;
            
            // Update chart
            updateChart(data.trend);
            
            // Update recommendations
            updateRecommendations(data.recommendations);
            
            // Update alerts
            updateAlerts(data.alerts);
        }
        
        function updateChart(trend) {
            const chart = document.getElementById('cost-chart');
            chart.innerHTML = '';
            
            const maxValue = Math.max(...trend);
            trend.forEach((value, index) => {
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = `${(value / maxValue) * 100}%`;
                bar.style.left = `${index * (100 / 7)}%`;
                bar.title = `Day ${index + 1}: $${value.toFixed(2)}`;
                chart.appendChild(bar);
            });
        }
        
        function updateRecommendations(recommendations) {
            const container = document.getElementById('recommendations');
            container.innerHTML = recommendations.map(rec => `
                <div class="recommendation">
                    <span class="recommendation-icon">üí°</span>
                    <span class="recommendation-text">${rec}</span>
                </div>
            `).join('');
        }
        
        function updateAlerts(alerts) {
            const container = document.getElementById('alerts');
            if (alerts.length === 0) {
                // Check for cost anomalies
                const budgetUsage = (mockData.currentCosts.projected / mockData.currentCosts.budget * 100);
                if (budgetUsage > 90) {
                    alerts.push({
                        type: 'cost',
                        message: `Cost projection exceeds 90% of monthly budget ($${mockData.currentCosts.projected.toFixed(2)} / $${mockData.currentCosts.budget})`
                    });
                }
            }
            
            container.innerHTML = alerts.map(alert => `
                <div class="alert">
                    <span class="alert-icon">‚ö†Ô∏è</span>
                    <span class="alert-text">${alert.message}</span>
                </div>
            `).join('');
        }
        
        function refreshDashboard() {
            // Simulate data refresh
            mockData.currentCosts.total += Math.random() * 5 - 2.5;
            mockData.usage.dailyRequests += Math.floor(Math.random() * 100000 - 50000);
            mockData.performance.avgLatency = Math.floor(Math.random() * 20 + 35);
            
            updateDashboard(mockData);
        }
        
        // Initial load
        updateDashboard(mockData);
        
        // Auto-refresh every 30 seconds
        setInterval(refreshDashboard, 30000);
    </script>
</body>
</html>