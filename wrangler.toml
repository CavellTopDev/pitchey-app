# Single production configuration - no environments
name = "pitchey-production"
main = "src/worker-production-db.ts"
compatibility_date = "2024-11-01"
compatibility_flags = ["nodejs_compat"]
account_id = "e16d3bf549153de23459a6c6a06a431b"

[vars]
JWT_SECRET = "vYGh89KjLmNpQrStUwXyZ123456789ABCDEFGHIJKLMNOPQRSTuvwxyz"
DATABASE_URL = "postgresql://neondb_owner:npg_DZhIpVaLAk06@ep-old-snow-abpr94lc-pooler.eu-west-2.aws.neon.tech/neondb?sslmode=require"
UPSTASH_REDIS_REST_URL = "https://chief-anteater-20186.upstash.io"
UPSTASH_REDIS_REST_TOKEN = "AU7aAAIncDI3ZGVjNWMxZGUyOWQ0ZmYyYjI4NzdkYjM4OGMxZTE3NnAyMjAxODY"
FRONTEND_URL = "https://pitchey.pages.dev"
ENVIRONMENT = "production"

# KV for static content caching and sessions
[[kv_namespaces]]
binding = "KV"
id = "98c88a185eb448e4868fcc87e458b3ac"

# R2 for file storage
[[r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "pitchey-uploads"

# Durable Objects for real-time features
[[durable_objects.bindings]]
name = "WEBSOCKET_ROOM"
class_name = "WebSocketRoom"

[[durable_objects.bindings]]
name = "NOTIFICATION_ROOM"
class_name = "NotificationRoom"

# Neon PostgreSQL via Hyperdrive (commented out for now, using direct connection)
# [[hyperdrive]]
# binding = "HYPERDRIVE"
# id = "983d4a1818264b5dbdca26bacf167dee"

# Migrations
[[migrations]]
tag = "v3"
new_sqlite_classes = ["WebSocketRoom"]

[[migrations]]
tag = "v4"
new_sqlite_classes = ["NotificationRoom"]

# Scheduled tasks (disabled for now due to limit)
# [triggers]
# crons = ["*/5 * * * *", "0 * * * *"]