// Authentication Fix for Demo Accounts
// Apply this patch to handlePortalLogin function in worker-integrated.ts

// Replace the isDemoAccount check section with:

        // For demo accounts, accept the demo password
        const isDemoAccount = ['alex.creator@demo.com', 'sarah.investor@demo.com', 'stellar.production@demo.com'].includes(email);
        
        // Password verification for demo accounts
        if (isDemoAccount) {
          // Demo accounts use password "Demo123"
          if (password !== 'Demo123') {
            return new Response(
              JSON.stringify({ 
                success: false, 
                error: { 
                  code: 'INVALID_CREDENTIALS',
                  message: 'Invalid credentials' 
                } 
              }),
              { 
                status: 401,
                headers: {
                  'Content-Type': 'application/json',
                  ...getCorsHeaders(request.headers.get('Origin'))
                }
              }
            );
          }
        } else {
          // For non-demo accounts, check password_hash (would need bcrypt verification)
          // For now, we'll check plain text password field as fallback
          if (user.password && user.password !== password) {
            return new Response(
              JSON.stringify({ 
                success: false, 
                error: { 
                  code: 'INVALID_CREDENTIALS',
                  message: 'Invalid credentials' 
                } 
              }),
              { 
                status: 401,
                headers: {
                  'Content-Type': 'application/json',
                  ...getCorsHeaders(request.headers.get('Origin'))
                }
              }
            );
          }
        }